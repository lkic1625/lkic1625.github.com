<!doctype html>
<!--
  Minimal Mistakes Jekyll Theme 4.19.3 by Michael Rose
  Copyright 2013-2019 Michael Rose - mademistakes.com | @mmistakes
  Free for personal and commercial use under the MIT license
  https://github.com/mmistakes/minimal-mistakes/blob/master/LICENSE
-->
<html lang="ko" class="no-js">
  <head>
    <meta charset="utf-8">

<!-- begin _includes/seo.html --><title>레디스 기본 데이터 타입  |  untitled</title>
<meta name="description" content="">


  <meta name="author" content="조원빈">


<meta property="og:type" content="article">
<meta property="og:locale" content="ko_KR">
<meta property="og:site_name" content="untitled">
<meta property="og:title" content="레디스 기본 데이터 타입">
<meta property="og:url" content="http://localhost:4000/redis/redis_00/">


  <meta property="og:description" content="">







  <meta property="article:published_time" content="2020-11-18T00:00:00+09:00">



  <meta property="article:modified_time" content="2020-11-16T04:00:00+09:00">



  

  


<link rel="canonical" href="http://localhost:4000/redis/redis_00/">




<script type="application/ld+json">
  {
    "@context": "https://schema.org",
    
      "@type": "Person",
      "name": "조원빈",
      "url": "http://localhost:4000/"
    
  }
</script>






<!-- end _includes/seo.html -->


<link href="/feed.xml" type="application/atom+xml" rel="alternate" title="untitled Feed">

<!-- https://t.co/dKP3o1e -->
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<script>
  document.documentElement.className = document.documentElement.className.replace(/\bno-js\b/g, '') + ' js ';
</script>

<!-- For all browsers -->
<link rel="stylesheet" href="/assets/css/main.css">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5/css/all.min.css">

<!--[if IE]>
  <style>
    /* old IE unsupported flexbox fixes */
    .greedy-nav .site-title {
      padding-right: 3em;
    }
    .greedy-nav button {
      position: absolute;
      top: 0;
      right: 0;
      height: 100%;
    }
  </style>
<![endif]-->



    <!-- start custom head snippets -->

<!-- insert favicons. use https://realfavicongenerator.net/ -->

<!-- end custom head snippets -->

  </head>

  <body class="layout--single">
    <nav class="skip-links">
  <h2 class="screen-reader-text">Skip links</h2>
  <ul>
    <li><a href="#site-nav" class="screen-reader-shortcut">Skip to primary navigation</a></li>
    <li><a href="#main" class="screen-reader-shortcut">Skip to content</a></li>
    <li><a href="#footer" class="screen-reader-shortcut">Skip to footer</a></li>
  </ul>
</nav>

    <!--[if lt IE 9]>
<div class="notice--danger align-center" style="margin: 0;">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience.</div>
<![endif]-->

    

<div class="masthead">
  <div class="masthead__inner-wrap">
    <div class="masthead__menu">
      <nav id="site-nav" class="greedy-nav">
        
        <a class="site-title" href="/">
          untitled
          <span class="site-subtitle">기록용 블로그입니다.</span>
        </a>
        <ul class="visible-links"><li class="masthead__menu-item">
              <a href="/categories/">Categories</a>
            </li><li class="masthead__menu-item">
              <a href="/tags/">Tags</a>
            </li><li class="masthead__menu-item">
              <a href="/about/">About</a>
            </li><li class="masthead__menu-item">
              <a href="/posts/">연도별 포스트</a>
            </li></ul>
        
        <button class="greedy-nav__toggle hidden" type="button">
          <span class="visually-hidden">토글 메뉴</span>
          <div class="navicon"></div>
        </button>
        <ul class="hidden-links hidden"></ul>
      </nav>
    </div>
  </div>
</div>


    <div class="initial-content">
      



<div id="main" role="main">
  
  <div class="sidebar sticky">
  


<div itemscope itemtype="https://schema.org/Person">

  
    <div class="author__avatar">
      
        <img src="/assets/images/avatar_logo2.jpg" alt="조원빈" itemprop="image">
      
    </div>
  

  <div class="author__content">
    
      <h3 class="author__name" itemprop="name">조원빈</h3>
    
    
      <div class="author__bio" itemprop="description">
        <p>Was mich nicht umbringt, macht mich stärker.</p>

      </div>
    
  </div>

  <div class="author__urls-wrapper">
    <button class="btn btn--inverse">팔로우</button>
    <ul class="author__urls social-icons">
      
        <li itemprop="homeLocation" itemscope itemtype="https://schema.org/Place">
          <i class="fas fa-fw fa-map-marker-alt" aria-hidden="true"></i> <span itemprop="name">South Korea</span>
        </li>
      

      
        
          
            <li><a href="mailto:lkic1625@gmail.com" rel="nofollow noopener noreferrer"><i class="fas fa-fw fa-envelope-square" aria-hidden="true"></i><span class="label">Email</span></a></li>
          
        
          
        
          
        
          
        
          
            <li><a href="https://github.com/lkic1625" rel="nofollow noopener noreferrer"><i class="fab fa-fw fa-github" aria-hidden="true"></i><span class="label">GitHub</span></a></li>
          
        
          
            <li><a href="https://www.instagram.com/__b1n__/" rel="nofollow noopener noreferrer"><i class="fab fa-fw fa-instagram" aria-hidden="true"></i><span class="label">Instagram</span></a></li>
          
        
      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      <!--
  <li>
    <a href="http://link-to-whatever-social-network.com/user/" itemprop="sameAs" rel="nofollow noopener noreferrer">
      <i class="fas fa-fw" aria-hidden="true"></i> Custom Social Profile Link
    </a>
  </li>
-->
    </ul>
  </div>
</div>

  
  </div>



  <article class="page" itemscope itemtype="https://schema.org/CreativeWork">
    <meta itemprop="headline" content="레디스 기본 데이터 타입">
    <meta itemprop="description" content="">
    <meta itemprop="datePublished" content="2020-11-18T00:00:00+09:00">
    <meta itemprop="dateModified" content="2020-11-16T04:00:00+09:00">

    <div class="page__inner-wrap">
      
        <header>
          <h1 id="page-title" class="page__title" itemprop="headline">레디스 기본 데이터 타입
</h1>
          
            <p class="page__meta"><i class="far fa-clock" aria-hidden="true"></i> 




  6 분 소요

</p>
          
        </header>
      

      <section class="page__content" itemprop="text">
        
          <aside class="sidebar__right ">
            <nav class="toc">
              <header><h4 class="nav__title"><i class="fas fa-file-alt"></i> On This Page</h4></header>
              <ul class="toc__menu">
  <li><a href="#redis">Redis?</a></li>
  <li><a href="#레디스-데이터-타입">레디스 데이터 타입</a>
    <ul>
      <li><a href="#string">String</a>
        <ul>
          <li><a href="#mest-mget">MEST MGET</a></li>
          <li><a href="#expire-ttl">EXPIRE TTL</a></li>
          <li><a href="#incr-incrby-incrbybloadt">INCR INCRBY INCRBYBLOADT</a></li>
          <li><a href="#nodejs-voting-system">Node.js voting system</a></li>
        </ul>
      </li>
      <li><a href="#lists">Lists</a>
        <ul>
          <li><a href="#list-examples-with-redis-cli">List examples with redis-cli</a></li>
        </ul>
      </li>
      <li><a href="#hashes">Hashes</a>
        <ul>
          <li><a href="#using-hashes-with-redis-cli">Using Hashes with redis-cli</a></li>
        </ul>
      </li>
    </ul>
  </li>
</ul>

            </nav>
          </aside>
        
        <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_HTML">
</script>

<h1 id="redis">Redis?</h1>

<p>길게 소개하자면 한도 끝도 없고, 나 말고도 필력 좋은 블로그들이 더 잘 소개했을 것 같기에 간단하게만 중점만 짚어 소개하자면,</p>

<p>레디스는 <code class="language-plaintext highlighter-rouge">In-Memory Database</code>로서 고가용성인 메모리에 저장하고 조회한다. 기존 관계형 데이터베이스 앞에 캐싱 시스템으로 이용하기 적합한 것으로 알려져있다. 오픈소스인만큼 다양한 서비스에서 사용되고 있으며, 앞으로 계속해서 중요한 역할을 할 것같아 책에 예제와 함께 내용을 정리해보려 한다.</p>

<p>이번 포스트에서는 레디스의 자료형에 대해 알아보겠다.</p>

<p>모든 내용은 책 <code class="language-plaintext highlighter-rouge">Maxwell Dayvson Da Silva, Redis Essentials</code>의 기반하고 있다.</p>

<h1 id="레디스-데이터-타입">레디스 데이터 타입</h1>

<p>레디스의 특징이라면 바로 다양한 자료구조를 지원한다는 점인데, 또 다른 <code class="language-plaintext highlighter-rouge">In-Memory Database</code>인 <code class="language-plaintext highlighter-rouge">Memcached</code>와 차이가 두드러진다</p>

<p><img src="/assets/images/redis-collection.png" alt="이미지" /></p>

<p>레디스는 기본적으로 <code class="language-plaintext highlighter-rouge">String</code>, <code class="language-plaintext highlighter-rouge">Bitmap</code>, <code class="language-plaintext highlighter-rouge">Hash</code>, <code class="language-plaintext highlighter-rouge">List</code>, <code class="language-plaintext highlighter-rouge">Set</code>, <code class="language-plaintext highlighter-rouge">Sorted</code> <code class="language-plaintext highlighter-rouge">Set</code> 를 제공했고, 버전이 올라가면서 현재는 <code class="language-plaintext highlighter-rouge">Geospatial Index</code>, <code class="language-plaintext highlighter-rouge">Hyperloglog</code>, <code class="language-plaintext highlighter-rouge">Stream</code> 등의 자료형도 지원하고 있다.
다양한 데이터 타입을 지원하는만큼 때에 따라 다양한 사용방법을 익히고 적용할 수 있다.</p>

<h2 id="string">String</h2>

<p>스트링 자료구조는 가장 보편적인 데이터 타입이다. 다목적 사용이 가능하며 여러 커맨드를 구비하고 있다.
텍스트 문자열과 정수, 비트맵 등 다양한 타입을 사용할 수 있다. 또한 어떤 형식의 데이터도 될 수 있으며, 512MB를 초과하지 않는 선에서 데이터 타입을 저장 가능하다.</p>

<ul>
  <li>Cache mechanism: 텍스트나 바이너리 데이터를 캐시 가능하며 API 응답, HTML 페이지의 이미지 혹은 비디오일 수 있다. 간단한 캐싱은 <code class="language-plaintext highlighter-rouge">SET</code>, <code class="language-plaintext highlighter-rouge">GET</code>, <code class="language-plaintext highlighter-rouge">MSET</code>, <code class="language-plaintext highlighter-rouge">MGET</code>을 이용하여 가능하다.</li>
  <li>Cache with automatic expiration: 자동 만료 키를 사용하여 캐싱을 효과적으로 이용할 수 있다. <code class="language-plaintext highlighter-rouge">SETEX</code>, <code class="language-plaintext highlighter-rouge">EXPIRE</code>, <code class="language-plaintext highlighter-rouge">EXPIREAT</code>와 같은 커맨드를 사용하며, 데이터베이스 실행 시간이 상당히 길며 캐싱을 같이해야 하는 경우 매우 유용할 수 있다.</li>
  <li>Counting: <code class="language-plaintext highlighter-rouge">INCR</code>, <code class="language-plaintext highlighter-rouge">INCRBY</code>를 통해 사용가능하다. 카운터는 <code class="language-plaintext highlighter-rouge">page view</code>, <code class="language-plaintext highlighter-rouge">video view</code>, <code class="language-plaintext highlighter-rouge">like</code>에 이용될 수 있으며, <code class="language-plaintext highlighter-rouge">DECR</code>, <code class="language-plaintext highlighter-rouge">DECRBY</code>, <code class="language-plaintext highlighter-rouge">INCRFLOATBY</code> 등도 제공한다.</li>
</ul>

<h3 id="mest-mget">MEST MGET</h3>
<p><code class="language-plaintext highlighter-rouge">MEST</code>은 다중 키 설정을 도와준다.</p>

<p><code class="language-plaintext highlighter-rouge">MGET</code>은 다중 키 획득을 도와준다.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ redis-cli
127.0.0.1:6379&gt; MSET first "First Key value" second "Second Key value"
OK
127.0.0.1:6379&gt; MGET first second
1) "First Key value"
2) "Second Key value"
</code></pre></div></div>

<h3 id="expire-ttl">EXPIRE TTL</h3>
<p><code class="language-plaintext highlighter-rouge">EXPIRE</code>는 키에 만료 시간을 설정할 수 있다. 만료시간이 자나면 자동으로 삭제되며, 만료시간이 성공적으로 설정되면 1, 아니면 0을 출력한다.</p>

<p><code class="language-plaintext highlighter-rouge">TTL</code>은 아래와 같은 값을 반환한다.</p>
<ul>
  <li>양수: 만료까지 남은 시간을 출력한다.</li>
  <li>-2: 키가 존재하지 않거나 만료되었을 경우 출력한다.</li>
  <li>-1: 키가 만료시간이 설정되지 않았을 경우 출력한다.</li>
</ul>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ redis-cli
127.0.0.1:6379&gt; SET current_chapter "Chapter 1"
OK
127.0.0.1:6379&gt; EXPIRE current_chapter 10
(integer) 1
127.0.0.1:6379&gt; GET current_chapter
"Chapter 1"
127.0.0.1:6379&gt; TTL current_chapter
(integer) 3
127.0.0.1:6379&gt; TTL current_chapter
(integer) -2
127.0.0.1:6379&gt; GET current_chapter
(nil)
</code></pre></div></div>

<h3 id="incr-incrby-incrbybloadt">INCR INCRBY INCRBYBLOADT</h3>

<p><code class="language-plaintext highlighter-rouge">INCR</code>과 <code class="language-plaintext highlighter-rouge">INCRBY</code>는 비슷한 기능을 지원한다.</p>

<p><code class="language-plaintext highlighter-rouge">INCR</code>은 키값을 1 올린 후 값을 리턴한다.
<code class="language-plaintext highlighter-rouge">INCRBY</code>는 주어진 정수 값을 토대로 키 값을 올린 후 값을 리턴한다.</p>

<p><code class="language-plaintext highlighter-rouge">DECR</code>과 <code class="language-plaintext highlighter-rouge">DECRBY</code>는 위 두 커맨드와 상반되게 키 값을 빼는 기능을 제공한다.</p>

<p><code class="language-plaintext highlighter-rouge">INCRBYFLOAT</code>는 <code class="language-plaintext highlighter-rouge">FLOAT</code> 값을 더할 수 있다.
위 세 커맨드 모드 양수 음수 모두 사용할 수 있다.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ redis-cli
127.0.0.1:6379&gt; SET counter 100
OK
127.0.0.1:6379&gt; INCR counter
(integer) 101
127.0.0.1:6379&gt; INCRBY counter 5
(integer) 106
127.0.0.1:6379&gt; DECR counter
(integer) 105
127.0.0.1:6379&gt; DECRBY counter 100
(integer) 5
127.0.0.1:6379&gt; GET counter
"5"
127.0.0.1:6379&gt; INCRBYFLOAT counter 2.4
"7.4"
</code></pre></div></div>

<p>위에 보여진 커맨드는 <code class="language-plaintext highlighter-rouge">ATOMIC</code>하다 즉, 하나의 오퍼레이션으로 취급한다는 것인데 이는 두 명의 서로 다른 클라이언트가 같은 시간의 같은 실행 명렁어를 통해 같은 값을 얻을 수 없다는 것이다.</p>

<p>예를들어, <code class="language-plaintext highlighter-rouge">counter</code> 키가 1이라면 서로 다른 클라이언트 A와 B가 <code class="language-plaintext highlighter-rouge">INCR</code>을 동시에 입력했을 때 A가 2 B가 3을 받게 될것이다.</p>

<blockquote>
  <p>Redis is single threaded, which means that it always executes one
command at a time. Sometimes, commands are mentioned as atomic,
which means that a race condition will never happen when multiple
clients try to perform operations on the same key at the same time.</p>
</blockquote>

<h3 id="nodejs-voting-system">Node.js voting system</h3>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">var</span> <span class="nx">redis</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="dl">"</span><span class="s2">redis</span><span class="dl">"</span><span class="p">);</span> <span class="c1">// 1</span>
<span class="kd">var</span> <span class="nx">client</span> <span class="o">=</span> <span class="nx">redis</span><span class="p">.</span><span class="nx">createClient</span><span class="p">();</span> <span class="c1">// 2</span>
<span class="kd">function</span> <span class="nx">upVote</span><span class="p">(</span><span class="nx">id</span><span class="p">)</span> <span class="p">{</span> <span class="c1">// 3</span>
 <span class="kd">var</span> <span class="nx">key</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">article:</span><span class="dl">"</span> <span class="o">+</span> <span class="nx">id</span> <span class="o">+</span> <span class="dl">"</span><span class="s2">:votes</span><span class="dl">"</span><span class="p">;</span> <span class="c1">// 4</span>
 <span class="nx">client</span><span class="p">.</span><span class="nx">incr</span><span class="p">(</span><span class="nx">key</span><span class="p">);</span> <span class="c1">// 5</span>
<span class="p">}</span>

<span class="kd">function</span> <span class="nx">downVote</span><span class="p">(</span><span class="nx">id</span><span class="p">)</span> <span class="p">{</span> <span class="c1">// 1</span>
 <span class="kd">var</span> <span class="nx">key</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">article:</span><span class="dl">"</span> <span class="o">+</span> <span class="nx">id</span> <span class="o">+</span> <span class="dl">"</span><span class="s2">:votes</span><span class="dl">"</span><span class="p">;</span> <span class="c1">// 2</span>
 <span class="nx">client</span><span class="p">.</span><span class="nx">decr</span><span class="p">(</span><span class="nx">key</span><span class="p">);</span> <span class="c1">// 3</span>
<span class="p">}</span>

<span class="kd">function</span> <span class="nx">showResults</span><span class="p">(</span><span class="nx">id</span><span class="p">)</span> <span class="p">{</span>
 <span class="kd">var</span> <span class="nx">headlineKey</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">article:</span><span class="dl">"</span> <span class="o">+</span> <span class="nx">id</span> <span class="o">+</span> <span class="dl">"</span><span class="s2">:headline</span><span class="dl">"</span><span class="p">;</span>
 <span class="kd">var</span> <span class="nx">voteKey</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">article:</span><span class="dl">"</span> <span class="o">+</span> <span class="nx">id</span> <span class="o">+</span> <span class="dl">"</span><span class="s2">:votes</span><span class="dl">"</span><span class="p">;</span>
 <span class="nx">client</span><span class="p">.</span><span class="nx">mget</span><span class="p">([</span><span class="nx">headlineKey</span><span class="p">,</span> <span class="nx">voteKey</span><span class="p">],</span> <span class="kd">function</span><span class="p">(</span><span class="nx">err</span><span class="p">,</span> <span class="nx">replies</span><span class="p">)</span> <span class="p">{</span> <span class="c1">// 1</span>
 <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">'</span><span class="s1">The article "</span><span class="dl">'</span> <span class="o">+</span> <span class="nx">replies</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="dl">'</span><span class="s1">" has</span><span class="dl">'</span><span class="p">,</span> <span class="nx">replies</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
 <span class="dl">'</span><span class="s1">votes</span><span class="dl">'</span><span class="p">);</span> <span class="c1">// 2</span>
 <span class="p">});</span>
<span class="p">}</span>
</code></pre></div></div>

<ol>
  <li><code class="language-plaintext highlighter-rouge">MGET</code>을 이용하여 키 배열과 콜백함수를 전달한다. 만약 키 값이 없다면 null을 리턴할 것이다.
<br />
익명함수 파라미터인 <code class="language-plaintext highlighter-rouge">replies</code>는 두 개의 밸류를 가진다. 각각 주어진 키 배열 순서대로 매핑된 값이다.</li>
</ol>

<p><code class="language-plaintext highlighter-rouge">Node.js</code> 클라이언트는 반드시 비동기적</p>

<h2 id="lists">Lists</h2>
<p>리스트는 레디스에서 매우 유동적인 데이터 타입이다. 스택, 큐와 같은 기능 또한 구현할 수 있으며, 많은 시스템들이 작업 큐를 사용하기 위해 리스트를 이용한다. 이는 동시성을 제공하는 시스템에서 리스트의 동작이 <code class="language-plaintext highlighter-rouge">atomic</code>하기 때문이다.</p>

<p>리스트에는 블록킹 커맨드가 존재한다. 만약 클라이언트가 블록킹 커맨드를 빈 리스트에 실행한다면 클라이언트는 새로운 아이템이 들어오기까지 기다린다.(blocking)</p>

<p>레디스 리스트는 <code class="language-plaintext highlighter-rouge">Linked List</code>로 구현되어 있기 때문에 맨앞과 맨뒤에 아이템을 <code class="language-plaintext highlighter-rouge">insertion</code>, <code class="language-plaintext highlighter-rouge">deletion</code>하는 과정이 \(O(1)\)만에 가능하다.
특정 아이템을 액세스 하는데에는 \(O(N)\)이 걸리며, 마찬가지로 맨 앞과 맨 뒤는 상수시간안에 가능하다.</p>

<p>리스트는 <code class="language-plaintext highlighter-rouge">list-max-ziplist-entries</code>값보다 작은 원소 개수와 ` list-max-ziplist-value` 값보다 작은 원소 값을 가진다면 최적화와 인코딩이 가능하다. 이는 추후 4챕터에서 알아보도록 하자.</p>

<p>실제 사용 예시</p>
<ul>
  <li>Event Queue: 이미 많은 툴에서 사용 중이다.</li>
  <li>Storing most recent user posts: 트위터는 최근 유저의 트윗을 리스트에 저장하여 이를 구현했다.</li>
</ul>

<h3 id="list-examples-with-redis-cli">List examples with redis-cli</h3>

<p>링크드 리스트인만큼 <code class="language-plaintext highlighter-rouge">head</code>와 <code class="language-plaintext highlighter-rouge">tail</code>에 데이터 삽입 삭제가 가능하다.</p>

<ul>
  <li><code class="language-plaintext highlighter-rouge">LPUSH</code>: <code class="language-plaintext highlighter-rouge">head</code>에 새로운 값을 넣는다.</li>
  <li><code class="language-plaintext highlighter-rouge">RPUSH</code>: <code class="language-plaintext highlighter-rouge">tail</code>에 새로운 값을 삽입한다.</li>
</ul>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code> $ redis-cli
127.0.0.1:6379&gt; LPUSH books "Clean Code"
(integer) 1
127.0.0.1:6379&gt; RPUSH books "Code Complete"
(integer) 2
127.0.0.1:6379&gt; LPUSH books "Peopleware"
(integer) 3
</code></pre></div></div>

<ul>
  <li><code class="language-plaintext highlighter-rouge">LLEN</code>: 리스트의 길이를 반환한다.</li>
  <li><code class="language-plaintext highlighter-rouge">LINDEX</code>: 주어진 인덱스에 저장된 값을 반환한다. 리스트를 수정하지 않는 커맨드다.</li>
</ul>

<p>인덱스는 항상 왼쪽에서 오른쪽으로 진행된다. <code class="language-plaintext highlighter-rouge">negative-index</code> 또한 가능하다.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ redis-cli
127.0.0.1:6379&gt; LLEN books
(integer) 3
127.0.0.1:6379&gt; LINDEX books 1
"Clean Code"
</code></pre></div></div>

<ul>
  <li><code class="language-plaintext highlighter-rouge">LRANGE</code>: 주어진 인덱스 범위 내에 값을 모두 리턴한다. 앞에서 언급했듯이 음수 인덱스가 가능하기에 아래와 같은 예제가 가능하다.</li>
</ul>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ redis-cli
127.0.0.1:6379&gt; LRANGE books 0 1
1) "Peopleware"
2) "Clean Code"
127.0.0.1:6379&gt; LRANGE books 0 -1
1) "Peopleware"
2) "Clean Code"
3) "Code Complete"
</code></pre></div></div>

<ul>
  <li><code class="language-plaintext highlighter-rouge">LPOP</code>: 가장 처음 원소를 리스트에서 제거하면서 동시에 반환한다.</li>
  <li><code class="language-plaintext highlighter-rouge">RPOP</code>: 가장 마지막 원소를 리스트에서 제거하면서 동시에 반환한다.</li>
</ul>

<p>위 둘은 <code class="language-plaintext highlighter-rouge">RINDEX</code>와 다르게 리스트를 수정하는 커맨드다.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ redis-cli
127.0.0.1:6379&gt; LPOP books
"Peopleware"
127.0.0.1:6379&gt; RPOP books
"Code Complete"
127.0.0.1:6379&gt; LRANGE books 0 -1
1) "Clean Code"
</code></pre></div></div>

<h2 id="hashes">Hashes</h2>

<p>해쉬는 오브젝트를 저장하기에 적절한 저장구조이다. 필드를 값에 대입할 수 있으며, 메모리 사용과 데이터 엑세스에 매우 최적화 돼있다.
해쉬는 <code class="language-plaintext highlighter-rouge">String to String</code> 매핑 구조이다.</p>

<p>우리는 위에서 투표 시스템 구현을 통해 일종의 <code class="language-plaintext highlighter-rouge">sematic</code>한 해쉬를 구현했다. 하지만, 해쉬를 사용하는 직접적인 이유는 메모리 최적화 때문이다.
<code class="language-plaintext highlighter-rouge">hash-max-ziplist-entries</code> 과 <code class="language-plaintext highlighter-rouge">hash-max-ziplist-value</code>를 통해 사용가능하며, 챕터 4에서 자세히 알아보겠다.</p>

<p>해쉬는 <code class="language-plaintext highlighter-rouge">hash table</code> 혹은 <code class="language-plaintext highlighter-rouge">ziplist</code>가 될 수 있다. <code class="language-plaintext highlighter-rouge">ziplist</code>는 메모리 최적화된 양방향 링크드 리스트다. 정수는 캐릭터 시퀀스 대신 실제 정수가 저장된다.
<code class="language-plaintext highlighter-rouge">ziplist</code>는 최적화에 불구하고 룩업에는 일정한 시간이 걸린다. 반면에 해시 테이블은 상수 시간에 탐색이 가능하지만 메모리 최적화는 되어있지 않다.</p>

<blockquote>
  <p>Instagram had to back-reference 300 million media IDs to user IDs,
and they decided to benchmark a Redis prototype using Strings
and Hashes. The String solution used one key per media ID and
around 21 GB of memory. The Hash solution used around 5 GB with
some configuration tweaks</p>
</blockquote>

<h3 id="using-hashes-with-redis-cli">Using Hashes with redis-cli</h3>

<ul>
  <li><code class="language-plaintext highlighter-rouge">HSET</code>: 필드에 주어진 키에 대해 값을 설정한다. <code class="language-plaintext highlighter-rouge">HSET key field value</code>와 같은 문법으로 사용할 수 있다.</li>
  <li><code class="language-plaintext highlighter-rouge">HMSET</code>: 여러 필드 값을 키에 설정할 수 있다. 스페이스로 구분한다.</li>
</ul>

<p>위 둘은 필드 값이 존재하지 않을 경우 생성하고 있을 경우 덮어쓰기를 진행한다.</p>

<ul>
  <li><code class="language-plaintext highlighter-rouge">HINCRBY</code>: 주어진 인티저 값을 필드에 더한다.</li>
  <li><code class="language-plaintext highlighter-rouge">HINCRBYFLOAT</code>:  <code class="language-plaintext highlighter-rouge">INCRBY</code> 과 <code class="language-plaintext highlighter-rouge">INCRBYFLOAT</code> 비슷하게 동작한다. 아래 코드에서 확인할 수 있다.</li>
</ul>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ redis-cli
127.0.0.1:6379&gt; HSET movie "title" "The Godfather"
(integer) 1
127.0.0.1:6379&gt; HMSET movie "year" 1972 "rating" 9.2 "watchers" 10000000
OK
127.0.0.1:6379&gt; HINCRBY movie "watchers" 3
(integer) 10000003
</code></pre></div></div>

<ul>
  <li><code class="language-plaintext highlighter-rouge">HGET</code>: 해쉬에서 필드를 반환한다.</li>
  <li><code class="language-plaintext highlighter-rouge">HMGET</code>: 필드들을 반환한다.</li>
</ul>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>127.0.0.1:6379&gt; HGET movie "title"
"The Godfather"
127.0.0.1:6379&gt; HMGET movie "title" "watchers"
1) "The Godfather"
2) "10000003"
</code></pre></div></div>

<ul>
  <li><code class="language-plaintext highlighter-rouge">HDEL</code>: 해쉬에서 필드를 삭제한다.</li>
</ul>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>127.0.0.1:6379&gt; HDEL movie "watchers"
(integer) 1
</code></pre></div></div>

<ul>
  <li><code class="language-plaintext highlighter-rouge">HGETALL</code>: 모든 필드/밸류 페어를 리턴한다.</li>
</ul>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>127.0.0.1:6379&gt; HGETALL movie
1) "title"
2) "The Godfather"
3) "year"
4) "1972"
5) "rating"
6) "9.2"
127.0.0.1:6379&gt;
</code></pre></div></div>

<ul>
  <li><code class="language-plaintext highlighter-rouge">HSCAN</code>: <code class="language-plaintext highlighter-rouge">HGETALL</code>은 해쉬가 많은 필드를 포함할 경우 매우 큰 메모리를 사용하여 레디스 성능의 영향을 미칠 수 있다. 이럴 경우 대책으로 <code class="language-plaintext highlighter-rouge">HSCAN</code>이 있다.
<code class="language-plaintext highlighter-rouge">HSCAN</code>은 모든필드를 리턴하지 않고 커서와 주어진 개수만큼 출력하게 한다.</li>
</ul>

<blockquote>
  <font size="6">Refernce</font>
  <ul>
    <li>https://medium.com/garimoo/개발자를-위한-레디스-튜토리얼-01-92aaa24ca8cc</li>
    <li>Maxwell Dayvson Da Silva, Redis Essentials</li>
  </ul>
</blockquote>

        
      </section>

      <footer class="page__meta">
        
        
  


  
  
  

  <p class="page__taxonomy">
    <strong><i class="fas fa-fw fa-tags" aria-hidden="true"></i> 태그: </strong>
    <span itemprop="keywords">
    
      
      
      <a href="/tags/#database" class="page__taxonomy-item" rel="tag">database</a><span class="sep">, </span>
    
      
      
      <a href="/tags/#nodejs" class="page__taxonomy-item" rel="tag">nodejs</a><span class="sep">, </span>
    
      
      
      <a href="/tags/#nosql" class="page__taxonomy-item" rel="tag">NoSQL</a><span class="sep">, </span>
    
      
      
      <a href="/tags/#redis" class="page__taxonomy-item" rel="tag">redis</a>
    
    </span>
  </p>




  


  
  
  

  <p class="page__taxonomy">
    <strong><i class="fas fa-fw fa-folder-open" aria-hidden="true"></i> 카테고리: </strong>
    <span itemprop="keywords">
    
      
      
      <a href="/categories/#redis" class="page__taxonomy-item" rel="tag">redis</a>
    
    </span>
  </p>


        
  <p class="page__date"><strong><i class="fas fa-fw fa-calendar-alt" aria-hidden="true"></i> 업데이트:</strong> <time datetime="2020-11-16">November 16, 2020</time></p>


      </footer>

      <section class="page__share">
  
    <h4 class="page__share-title">공유하기</h4>
  

  <a href="https://twitter.com/intent/tweet?text=%EB%A0%88%EB%94%94%EC%8A%A4+%EA%B8%B0%EB%B3%B8+%EB%8D%B0%EC%9D%B4%ED%84%B0+%ED%83%80%EC%9E%85%20http%3A%2F%2Flocalhost%3A4000%2Fredis%2Fredis_00%2F" class="btn btn--twitter" onclick="window.open(this.href, 'window', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" title="공유하기 Twitter"><i class="fab fa-fw fa-twitter" aria-hidden="true"></i><span> Twitter</span></a>

  <a href="https://www.facebook.com/sharer/sharer.php?u=http%3A%2F%2Flocalhost%3A4000%2Fredis%2Fredis_00%2F" class="btn btn--facebook" onclick="window.open(this.href, 'window', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" title="공유하기 Facebook"><i class="fab fa-fw fa-facebook" aria-hidden="true"></i><span> Facebook</span></a>

  <a href="https://www.linkedin.com/shareArticle?mini=true&url=http%3A%2F%2Flocalhost%3A4000%2Fredis%2Fredis_00%2F" class="btn btn--linkedin" onclick="window.open(this.href, 'window', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" title="공유하기 LinkedIn"><i class="fab fa-fw fa-linkedin" aria-hidden="true"></i><span> LinkedIn</span></a>
</section>


      
  <nav class="pagination">
    
      <a href="/database/innoDB_index_page/" class="pagination--pager" title="InnoDB 인덱스 페이지 구조
">이전</a>
    
    
      <a href="/backend/FaaS_BaaS/" class="pagination--pager" title="FaaS, BaaS
">다음</a>
    
  </nav>

    </div>

    
  </article>

  
  
    <div class="page__related">
      <h4 class="page__related-title">참고</h4>
      <div class="grid__wrapper">
        
          



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
    <h2 class="archive__item-title" itemprop="headline">
      
        <a href="/programming/meaningful_naming/" rel="permalink">의미있는 변수명
</a>
      
    </h2>
    
      <p class="page__meta"><i class="far fa-clock" aria-hidden="true"></i> 




  1 분 소요

</p>
    
    <p class="archive__item-excerpt" itemprop="description">Introduction
</p>
  </article>
</div>

        
          



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
    <h2 class="archive__item-title" itemprop="headline">
      
        <a href="/redis/time_series_with_redis/" rel="permalink">시계열 데이터 관측
</a>
      
    </h2>
    
      <p class="page__meta"><i class="far fa-clock" aria-hidden="true"></i> 




  최대 1 분 소요

</p>
    
    <p class="archive__item-excerpt" itemprop="description">

</p>
  </article>
</div>

        
          



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
    <h2 class="archive__item-title" itemprop="headline">
      
        <a href="/programming/diamond_problem/" rel="permalink">Diamond Problem
</a>
      
    </h2>
    
      <p class="page__meta"><i class="far fa-clock" aria-hidden="true"></i> 




  3 분 소요

</p>
    
    <p class="archive__item-excerpt" itemprop="description">Introduction
</p>
  </article>
</div>

        
          



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
    <h2 class="archive__item-title" itemprop="headline">
      
        <a href="/backend/websocket/" rel="permalink">WebSocket
</a>
      
    </h2>
    
      <p class="page__meta"><i class="far fa-clock" aria-hidden="true"></i> 




  6 분 소요

</p>
    
    <p class="archive__item-excerpt" itemprop="description">Introduction
</p>
  </article>
</div>

        
      </div>
    </div>
  
  
</div>

    </div>

    

    <div id="footer" class="page__footer">
      <footer>
        <!-- start custom footer snippets -->

<!-- end custom footer snippets -->
        <div class="page__footer-follow">
  <ul class="social-icons">
    
      <li><strong>팔로우:</strong></li>
    

    
      
        
      
        
      
        
          <li><a href="https://github.com/lkic1625" rel="nofollow noopener noreferrer"><i class="fab fa-fw fa-github" aria-hidden="true"></i> GitHub</a></li>
        
      
        
      
        
      
        
          <li><a href="https://www.instagram.com/__b1n__/" rel="nofollow noopener noreferrer"><i class="fab fa-fw fa-instagram" aria-hidden="true"></i> Instagram</a></li>
        
      
    

    <li><a href="/feed.xml"><i class="fas fa-fw fa-rss-square" aria-hidden="true"></i> 피드</a></li>
  </ul>
</div>

<div class="page__footer-copyright">&copy; 2020 조원빈. Powered by <a href="https://jekyllrb.com" rel="nofollow">Jekyll</a> &amp; <a href="https://mademistakes.com/work/minimal-mistakes-jekyll-theme/" rel="nofollow">Minimal Mistakes</a>.</div>

      </footer>
    </div>

    
  <script src="/assets/js/main.min.js"></script>










  </body>
</html>
